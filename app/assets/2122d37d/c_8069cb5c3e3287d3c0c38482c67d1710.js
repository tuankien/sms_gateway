
(function($){var selectCheckedRows,methods,gridSettings=[];selectCheckedRows=function(gridId){var settings=gridSettings[gridId],table=$('#'+gridId).children('.'+settings.tableClass);table.children('tbody').find('input.select-on-check').filter(':checked').each(function(){$(this).closest('tr').addClass('selected');});table.children('thead').find('th input').filter('[type="checkbox"]').each(function(){var name=this.name.substring(0,this.name.length-4)+'[]',$checks=$("input[name='"+name+"']",table);this.checked=$checks.length>0&&$checks.length===$checks.filter(':checked').length;});return this;};methods={init:function(options){var settings=$.extend({ajaxUpdate:[],ajaxVar:'ajax',pagerClass:'pager',loadingClass:'loading',filterClass:'filters',tableClass:'items',selectableRows:1},options||{});settings.tableClass=settings.tableClass.replace(/\s+/g,'.');return this.each(function(){var eventType,$grid=$(this),id=$grid.attr('id'),pagerSelector='#'+id+' .'+settings.pagerClass.replace(/\s+/g,'.')+' a',sortSelector='#'+id+' .'+settings.tableClass+' thead th a.sort-link',inputSelector='#'+id+' .'+settings.filterClass+' input, '+'#'+id+' .'+settings.filterClass+' select';settings.updateSelector=settings.updateSelector.replace('{page}',pagerSelector).replace('{sort}',sortSelector);settings.filterSelector=settings.filterSelector.replace('{filter}',inputSelector);gridSettings[id]=settings;if(settings.ajaxUpdate.length>0){$(document).on('click.yiiGridView',settings.updateSelector,function(){if(settings.enableHistory&&window.History.enabled){var url=$(this).attr('href').split('?'),params=$.deparam.querystring('?'+url[1]);delete params[settings.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent($.param.querystring(url[0],params)));}else{$('#'+id).yiiGridView('update',{url:$(this).attr('href')});}
return false;});}
$(document).on('change.yiiGridView keydown.yiiGridView',settings.filterSelector,function(event){if(event.type==='keydown'){if(event.keyCode!==13){return;}else{eventType='keydown';}}else{if(eventType==='keydown'){eventType='';return;}}
var data=$(settings.filterSelector).serialize();if(settings.pageVar!==undefined){data+='&'+settings.pageVar+'=1';}
if(settings.enableHistory&&settings.ajaxUpdate!==false&&window.History.enabled){var url=$('#'+id).yiiGridView('getUrl'),params=$.deparam.querystring($.param.querystring(url,data));delete params[settings.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent($.param.querystring(url.substr(0,url.indexOf('?')),params)));}else{$('#'+id).yiiGridView('update',{data:data});}});if(settings.enableHistory&&settings.ajaxUpdate!==false&&window.History.enabled){$(window).bind('statechange',function(){var State=window.History.getState();$('#'+id).yiiGridView('update',{url:State.url});});}
if(settings.selectableRows>0){selectCheckedRows(this.id);$(document).on('click.yiiGridView','#'+id+' .'+settings.tableClass+' > tbody > tr',function(e){var $currentGrid,$row,isRowSelected,$checks,$target=$(e.target);if($target.closest('td').is('.empty,.button-column')||(e.target.type==='checkbox'&&!$target.hasClass('select-on-check'))){return;}
$row=$(this);$currentGrid=$('#'+id);$checks=$('input.select-on-check',$currentGrid);isRowSelected=$row.toggleClass('selected').hasClass('selected');if(settings.selectableRows===1){$row.siblings().removeClass('selected');$checks.prop('checked',false);}
$('input.select-on-check',$row).prop('checked',isRowSelected);$("input.select-on-check-all",$currentGrid).prop('checked',$checks.length===$checks.filter(':checked').length);if(settings.selectionChanged!==undefined){settings.selectionChanged(id);}});if(settings.selectableRows>1){$(document).on('click.yiiGridView','#'+id+' .select-on-check-all',function(){var $currentGrid=$('#'+id),$checks=$('input.select-on-check',$currentGrid),$checksAll=$('input.select-on-check-all',$currentGrid),$rows=$currentGrid.children('.'+settings.tableClass).children('tbody').children();if(this.checked){$rows.addClass('selected');$checks.prop('checked',true);$checksAll.prop('checked',true);}else{$rows.removeClass('selected');$checks.prop('checked',false);$checksAll.prop('checked',false);}
if(settings.selectionChanged!==undefined){settings.selectionChanged(id);}});}}else{$(document).on('click.yiiGridView','#'+id+' .select-on-check',false);}});},getKey:function(row){return this.children('.keys').children('span').eq(row).text();},getUrl:function(){var sUrl=gridSettings[this.attr('id')].url;return sUrl||this.children('.keys').attr('title');},getRow:function(row){var sClass=gridSettings[this.attr('id')].tableClass;return this.children('.'+sClass).children('tbody').children('tr').eq(row).children();},getColumn:function(column){var sClass=gridSettings[this.attr('id')].tableClass;return this.children('.'+sClass).children('tbody').children('tr').children('td:nth-child('+(column+1)+')');},update:function(options){var customError;if(options&&options.error!==undefined){customError=options.error;delete options.error;}
return this.each(function(){var $form,$grid=$(this),id=$grid.attr('id'),settings=gridSettings[id];$grid.addClass(settings.loadingClass);options=$.extend({type:'GET',url:$grid.yiiGridView('getUrl'),success:function(data){var $data=$('<div>'+data+'</div>');$grid.removeClass(settings.loadingClass);$.each(settings.ajaxUpdate,function(i,el){var updateId='#'+el;$(updateId).replaceWith($(updateId,$data));});if(settings.afterAjaxUpdate!==undefined){settings.afterAjaxUpdate(id,data);}
if(settings.selectableRows>0){selectCheckedRows(id);}},error:function(XHR,textStatus,errorThrown){var ret,err;$grid.removeClass(settings.loadingClass);if(XHR.readyState===0||XHR.status===0){return;}
if(customError!==undefined){ret=customError(XHR);if(ret!==undefined&&!ret){return;}}
switch(textStatus){case'timeout':err='The request timed out!';break;case'parsererror':err='Parser error!';break;case'error':if(XHR.status&&!/^\s*$/.test(XHR.status)){err='Error '+XHR.status;}else{err='Error';}
if(XHR.responseText&&!/^\s*$/.test(XHR.responseText)){err=err+': '+XHR.responseText;}
break;}
if(settings.ajaxUpdateError!==undefined){settings.ajaxUpdateError(XHR,textStatus,errorThrown,err);}else if(err){alert(err);}}},options||{});if(options.data!==undefined&&options.type==='GET'){options.url=$.param.querystring(options.url,options.data);options.data={};}
if(settings.ajaxUpdate!==false){options.url=$.param.querystring(options.url,settings.ajaxVar+'='+id);if(settings.beforeAjaxUpdate!==undefined){settings.beforeAjaxUpdate(id,options);}
$.ajax(options);}else{if(options.type==='GET'){window.location.href=options.url;}else{$form=$('<form action="'+options.url+'" method="post"></form>').appendTo('body');if(options.data===undefined){options.data={};}
if(options.data.returnUrl===undefined){options.data.returnUrl=window.location.href;}
$.each(options.data,function(name,value){$form.append($('<input type="hidden" name="t" value="" />').attr('name',name).val(value));});$form.submit();}}});},getSelection:function(){var settings=gridSettings[this.attr('id')],keys=this.find('.keys span'),selection=[];this.find('.'+settings.tableClass).children('tbody').children().each(function(i){if($(this).hasClass('selected')){selection.push(keys.eq(i).text());}});return selection;},getChecked:function(column_id){var settings=gridSettings[this.attr('id')],keys=this.find('.keys span'),checked=[];if(column_id.substring(column_id.length-2)!=='[]'){column_id=column_id+'[]';}
this.find('.'+settings.tableClass).children('tbody').children('tr').children('td').children('input[name="'+column_id+'"]').each(function(i){if(this.checked){checked.push(keys.eq(i).text());}});return checked;}};$.fn.yiiGridView=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.yiiGridView');return false;}};$.fn.yiiGridView.settings=gridSettings;$.fn.yiiGridView.getKey=function(id,row){return $('#'+id).yiiGridView('getKey',row);};$.fn.yiiGridView.getUrl=function(id){return $('#'+id).yiiGridView('getUrl');};$.fn.yiiGridView.getRow=function(id,row){return $('#'+id).yiiGridView('getRow',row);};$.fn.yiiGridView.getColumn=function(id,column){return $('#'+id).yiiGridView('getColumn',column);};$.fn.yiiGridView.update=function(id,options){$('#'+id).yiiGridView('update',options);};$.fn.yiiGridView.getSelection=function(id){return $('#'+id).yiiGridView('getSelection');};$.fn.yiiGridView.getChecked=function(id,column_id){return $('#'+id).yiiGridView('getChecked',column_id);};})(jQuery);
$(document).ready(function(){$(".numbersOnly").bind('keyup paste',function(e){var ob=$(this);if(e.type=='paste'){setTimeout(function(){numbersOnly(ob)},1);}else numbersOnly(ob);});$('.floatOnly').keyup(function(){this.value=this.value.replace(/[^0-9\.]/g,'');});$('.items .icon-status').live('click',function(){mName=$('#moduleName').val();img=this;$.ajax({type:'POST',url:baseUrl+'/'+mName+'/changeStatus',data:{id:img.name,ajax:true,YII_CSRF_TOKEN:YII_CSRF_TOKEN},success:function(){if(img.alt=='enabled'){img.alt='disabled';img.src=baseUrl+'/css/admin/images/publish_x.png';}else{img.alt='enabled';img.src=baseUrl+'/css/admin/images/tick.png';}}});});});function numbersOnly(ob){ob.val(ob.val().replace(/[^0-9]/g,''));}
function deleteAll(containerID,url){var $selection=$.fn.yiiGridView.getSelection(containerID);if($selection=="")
{alert(LANG.DELETE_CHECKBOX_EMPTY);return;}
if(confirm(LANG.DELETE_ALL_CONFIRM))
{$.ajax({type:'POST',url:baseUrl+url,data:{ids:$selection,YII_CSRF_TOKEN:YII_CSRF_TOKEN},success:function($redirect){location.href=$redirect;}});}
return;}
function changeStatus(id,idReturn,ctrl){$('.grid-view').addClass('loading');$.ajax({type:"POST",url:baseUrl+"/"+ctrl+'/changeStatus',data:"id="+id+"&ajax=1&YII_CSRF_TOKEN="+YII_CSRF_TOKEN,success:function(data){if(data=='0')
$src=baseUrl+'/css/admin/images/publish_x.png';else
$src=baseUrl+'/css/admin/images/tick.png';$('#'+idReturn).attr('src',$src);$('.grid-view').removeClass('loading');}});}
function loadPage(url,id){$('.grid-view').addClass('loading');$.ajax({type:"GET",url:baseUrl+url,data:"ajax=1&YII_CSRF_TOKEN="+YII_CSRF_TOKEN,success:function(data){$('#'+id).html(data);$('.grid-view').removeClass('loading');}});}
function removeTableRow(index,tab){rowCount=$('#table-'+tab+'-grid tr').length;$('#'+tab+'-no-'+index).parent().remove();for(i=(index+1);i<rowCount+1;i++){$('#'+tab+'-no-'+i).html(i-1);$('#'+tab+'-no-'+i).attr('id',tab+'-no-'+(i-1));$('#'+tab+'-remove-row-'+i).html('<img src="'+assetPath+'/gridview/delete.png" onclick="removeTableRow('+(i-1)+', \''+tab+'\')"/>');$('#'+tab+'-remove-row-'+i).attr('id',tab+'-remove-row-'+(i-1));}}
function changeOptionStatus(attr,opt,pos){if(opt.checked){$('#'+attr+'_disabled_'+pos).attr('style','display: none');document.getElementById(attr+'_file_'+pos).disabled=true;}else{$('#'+attr+'_disabled_'+pos).attr('style','display: inline');document.getElementById(attr+'_file_'+pos).disabled=false;}}
function removeGroupItem(itemId,tabName,rmPrefix){if(tabName==undefined)
var tabName='group_item';if(rmPrefix==undefined)
var rmPrefix='group-item';ids=$('#'+tabName+'_id_list');itemIds=ids.val().split(",");for(var i=0;i<itemIds.length;i++){if(itemIds[i]==itemId){itemIds.splice(i,1);$('#group-remove-'+rmPrefix+'-'+itemId).parent().parent().remove();ids.attr('value',itemIds);if(ids.val()=="")
$('#group-btn-delete-rows').attr('disabled','disabled');return;}}}
function removeItem(itemId,listId,rmPrefix,idDelete){itemIds=$('#'+listId).val().split(",");for(var i=0;i<itemIds.length;i++){if(itemIds[i]==itemId){itemIds.splice(i,1);$('#'+rmPrefix+'-'+itemId).parent().parent().remove();$('#'+listId).attr('value',itemIds);if($("#"+listId).val()=="")
$('#'+idDelete).attr('disabled','disabled');if(itemPrices!=null){itemPrices.splice(i,1);$('#item_price_list').attr('value',itemPrices);}
return;}}}
function removeMoreItem(tabName){if(!$("input[name='select-row[]']:checked").attr('checked')){alert(LANG.DELETE_CHECKBOX_EMPTY);return;}
$("INPUT[name='select-row[]']:checked").each(function(){removeOneItem($(this).val(),tabName);});return;}
function sortArray(a,sortField,sort,array){if(array!='')
{$.ajax({type:"POST",url:baseUrl+'/statistic/sortArray',data:{sortField:sortField,sort:sort,data:array,key:a.rel,ajax:1},success:function(data){$('#report-data').html(data);}});}
return false;}
function gridviewDeleteButton(url){if(confirm(LANG.DELETE_ALL_CONFIRM)){window.location.href=url;}
return false;}
function removeSigned(str){str=str.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a");str=str.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e");str=str.replace(/ì|í|ị|ỉ|ĩ/g,"i");str=str.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o");str=str.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u");str=str.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y");str=str.replace(/đ/g,"d");str=str.replace(/À|Á|Ạ|Ả|Ã|Â|Ầ|Ấ|Ậ|Ẩ|Ẫ|Ă|Ằ|Ắ|Ặ|Ẳ|Ẵ/g,"A");str=str.replace(/È|É|Ẹ|Ẻ|Ẽ|Ê|Ề|Ế|Ệ|Ể|Ễ/g,"E");str=str.replace(/Ì|Í|Ị|Ỉ|Ĩ/g,"I");str=str.replace(/Ò|Ó|Ọ|Ỏ|Õ|Ô|Ồ|Ố|Ộ|Ổ|Ỗ|Ơ|Ờ|Ớ|Ợ|Ở|Ỡ/g,"O");str=str.replace(/Ù|Ú|Ụ|Ủ|Ũ|Ư|Ừ|Ứ|Ự|Ử|Ữ/g,"U");str=str.replace(/Ỳ|Ý|Ỵ|Ỷ|Ỹ/g,"Y");str=str.replace(/Đ/g,"D");str=str.replace(/-+-/g,"-");str=str.replace(/^\-+|\-+$/g,"");return str;}
function showMenthodSoap()
{var x=document.getElementById("protocol");x=x.value;if(x=='SOAP')
{$('.wsdl').show('10000');$('.http').hide('10000');$('.menthod_soap').show('10000');}
else
{$('.http').show('10000');$('.wsdl').hide('10000');$('.menthod_soap').hide('10000');}}
function showWapPush()
{var x=document.getElementById("msg_type");x=x.value;if(x=='1')
{$('.wap_push').show('10000');}
else
{$('.wap_push').hide('10000');}}
function searchSmsService($keyword,$smsc)
{$.ajax({type:"GET",url:baseUrl+'/smsService/getServices',data:{keyword:$keyword,smsc:$smsc},success:function(data){$('#showDuplicateService').hide();$('#showDuplicateService').html(data);$('#showDuplicateService').slideDown();}});}